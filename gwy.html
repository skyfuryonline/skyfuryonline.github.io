---
layout: gwy_layout
title: "Gwy"
nav-order: 1
---

<!-- 1. æ•°æ®å‡†å¤‡ (ç”¨äºçƒ­åŠ›å›¾å’Œæ ¼è¨€) -->
<script>
    const quotes = [
        {% for quote in site.data.gwy_quotes %}
        "{{ quote.text }}",
        {% endfor %}
    ];

    const studyLogs = {
        {% for log in site.gwy_logs %}
        "{{ log.date | date: '%Y-%m-%d' }}": {{ log.study_hours | default: 0 }},
        {% endfor %}
    };

    document.addEventListener('DOMContentLoaded', function() {
        // --- A. éšæœºæ ¼è¨€ ---
        if (quotes.length > 0) {
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            const quoteEl = document.getElementById('daily-quote');
            if(quoteEl) quoteEl.textContent = "â€œ" + randomQuote + "â€";
        }

        // --- B. çƒ­åŠ›å›¾ç”Ÿæˆ ---
        const heatmapContainer = document.getElementById('study-heatmap');
        if(heatmapContainer) {
            const today = new Date();
            const oneYearAgo = new Date();
            oneYearAgo.setFullYear(today.getFullYear() - 1);
            
            for (let d = new Date(oneYearAgo); d <= today; d.setDate(d.getDate() + 1)) {
                const dateStr = d.toISOString().split('T')[0];
                const hours = studyLogs[dateStr] || 0;
                const cell = document.createElement('div');
                cell.classList.add('heatmap-cell');
                
                let level = 0;
                if (hours > 0) level = 1;
                if (hours >= 2) level = 2;
                if (hours >= 4) level = 3;
                if (hours >= 6) level = 4;
                
                cell.classList.add(`level-${level}`);
                cell.title = `${dateStr}: ${hours} hrs`; 
                heatmapContainer.appendChild(cell);
            }
        }

        // --- C. ç»Ÿè®¡æ•°æ®è®¡ç®— ---
        let totalHours = 0;
        let totalDays = 0;
        let currentStreak = 0;
        
        // 1. æ€»æ—¶é•¿ & æ€»å¤©æ•°
        for (let date in studyLogs) {
            if (studyLogs[date] > 0) {
                totalHours += studyLogs[date];
                totalDays++;
            }
        }

        // 2. è¿ç»­æ‰“å¡ (Streak)
        // é€»è¾‘ï¼šä»æ˜¨å¤©å¼€å§‹å€’æ¨ï¼Œå¦‚æœæ˜¨å¤©æ²¡æ‰“å¡ï¼Œçœ‹ä»Šå¤©æœ‰æ²¡æœ‰ã€‚å¦‚æœéƒ½æ²¡æœ‰ï¼Œstreak=0ã€‚
        const todayStr = new Date().toISOString().split('T')[0];
        let checkDate = new Date();
        
        // å…ˆæ£€æŸ¥ä»Šå¤©æ˜¯å¦å·²æ‰“å¡ï¼Œå¦‚æœæ‰“äº†ï¼Œstreak è‡³å°‘ä¸º 1
        if (studyLogs[todayStr] > 0) {
            currentStreak = 1;
        }
        
        // ä»æ˜¨å¤©å¼€å§‹å€’æ¨
        checkDate.setDate(checkDate.getDate() - 1);
        while (true) {
            const checkStr = checkDate.toISOString().split('T')[0];
            if (studyLogs[checkStr] > 0) {
                currentStreak++;
                checkDate.setDate(checkDate.getDate() - 1);
            } else {
                break;
            }
        }

        // --- D. æ›´æ–° UI ---
        document.getElementById('stat-total-hours').textContent = totalHours.toFixed(1);
        document.getElementById('stat-days').textContent = totalDays;
        document.getElementById('stat-streak').textContent = currentStreak;
    });
</script>

<!-- 2. æ—¶é—´è½´å†…å®¹ (Liquid æ¸²æŸ“) -->
{% assign logs = site.gwy_logs | sort: 'date' | reverse %}
{% for log in logs %}
<div class="timeline-item">
    <div class="timeline-dot"></div>
    <div class="timeline-date">{{ log.date | date: "%Yå¹´%mæœˆ%dæ—¥" }}</div>
    <div class="timeline-card">
        <h3 class="timeline-title">{{ log.title }}</h3>
        <div class="timeline-meta">
            <span>â±ï¸ å­¦ä¹  {{ log.study_hours }} å°æ—¶</span>
            {% if log.tags %}
            <span style="margin-left: 10px;">ğŸ·ï¸ {{ log.tags | join: ", " }}</span>
            {% endif %}
        </div>
        <div class="timeline-content">
            {{ log.content | markdownify }}
        </div>
    </div>
</div>
{% endfor %}
