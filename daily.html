---
layout: page
title: "DAILY"
description: "每日信息聚合"
header-img: "img/daily-bg.jpg"
http_headers:
  "Cache-Control": "no-cache, no-store, must-revalidate"
  "Pragma": "no-cache"
  "Expires": "0"
---

<style>
/* --- Card Styles (Copied from index.html) --- */
.daily-container {
    display: flex;
    flex-wrap: wrap;
    margin: 0 -15px; /* Counteract column padding */
}

.square-card-wrapper {
    padding: 0 15px;
    margin-bottom: 30px;
    width: 100%;
}

@media (min-width: 768px) {
    .square-card-wrapper {
        width: 50%;
    }
}

.square-card {
    position: relative;
    width: 100%;
    height: 0;
    padding-bottom: 50%; /* Halved the height to make it a rectangle */
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    background-color: #f8f9fa; /* Added a very light gray background */
    cursor: pointer;
}

.square-card-link {
    display: block;
    text-decoration: none;
    color: inherit;
}

.square-card-link:hover .square-card {
    box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    transform: translateY(-5px);
}

.square-card-content {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    padding: 25px;
    display: flex;
    flex-direction: column;
    justify-content: center; /* Center content vertically */
    align-items: center;   /* Center content horizontally */
    text-align: center;
}

.square-card-title {
    font-size: 1.3em;
    font-weight: 600;
    color: #333;
    margin: 0;
}

.square-card-meta {
    font-size: 0.9em;
    color: #888;
    margin-top: 10px;
}

.date-header {
    width: 100%;
    text-align: center;
    margin-bottom: 20px;
    color: #555;
    font-size: 2em;
}

/* --- Modal Body Scrolling (Fallback) --- */
.modal-body {
    max-height: 80vh; /* Max height is 80% of viewport height */
    overflow-y: auto; /* Add vertical scrollbar ONLY if content overflows */
}

/* --- Modal Image Gallery Styles (Primary Fix) --- */
.image-gallery {
    display: flex;
    flex-wrap: wrap;
    gap: 10px; /* Spacing between images */
    margin-top: 20px;
}

#summaryModal .gallery-item { /* Use ID for higher specificity */
    flex: 1 1 100%;
    height: 200px; /* Give the container a fixed height */
    border-radius: 5px;
    overflow: hidden; /* This is crucial for cropping the image */
    background-color: #ddd; /* Darker placeholder for contain view */
}

#summaryModal .gallery-item img {
    width: 100%;
    height: 100%; /* Make image fill the container */
    object-fit: contain; /* Contain the image fully, may leave empty space */
    display: block;
}

@media (min-width: 576px) {
    #summaryModal .gallery-item {
        flex-basis: calc(50% - 5px);
    }
}

@media (min-width: 992px) {
    #summaryModal .gallery-item {
        flex-basis: calc(33.333% - 7px);
    }
}
</style>

{% comment %} 
The layout 'page.html' already provides the main container and row.
We only need to provide the content that goes inside the `col-lg-8` div.
{% endcomment %}

{% assign daily_file_names = "" | split: "" %}
{% for file in site.data %}
    {% if file[0] contains "daily_" %}
        {% assign daily_file_names = daily_file_names | push: file[0] %}
    {% endif %}
{% endfor %}
{% assign daily_file_names = daily_file_names | sort | reverse %}

{% if daily_file_names.size > 0 %}
    {% for file_name in daily_file_names %}
        {% assign file_date_str = file_name | remove: "daily_" %}
        {% assign articles = site.data[file_name] %}

        <h2 class="date-header">{{ file_date_str }}</h2>
        
        <div class="daily-container">
            {% if articles.size > 0 %}
                {% for article in articles %}
                    <div class="square-card-wrapper">
                        <div class="daily-article-card" 
                             data-title="{{ article.title | escape }}"
                             data-summary="{{ article.summary | escape }}"
                             data-link="{{ article.link }}"
                             data-cache-path="{{ article.cache_path }}"
                             data-images='{{ article.image_files | join: "," }}'>
                            <div class="square-card">
                                <div class="square-card-content">
                                    <h3 class="square-card-title">{{ article.title }}</h3>
                                    <p class="square-card-meta">Source: cnblogs</p>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p class="text-center" style="width: 100%;">No articles found for this day.</p>
            {% endif %}
        </div>
    {% endfor %}
{% else %}
    <div class="daily-container">
        <p class="text-center" style="width: 100%; margin-top: 50px;">No daily information available yet.</p>
    </div>
{% endif %}

<!-- Bootstrap Modal -->
<div class="modal fade" id="summaryModal" tabindex="-1" role="dialog" aria-labelledby="summaryModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="summaryModalLabel">Article Summary</h4>
      </div>
      <div class="modal-body">
        <p id="modalSummaryContent"></p>
        <hr>
        <div id="modalImageGallery" class="image-gallery"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <a id="modalReadMoreBtn" href="#" target="_blank" class="btn btn-primary">Read Original</a>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    var cards = document.querySelectorAll('.daily-article-card');
    var modal = $('#summaryModal');
    var modalTitle = document.getElementById('summaryModalLabel');
    var modalSummary = document.getElementById('modalSummaryContent');
    var modalGallery = document.getElementById('modalImageGallery');
    var modalReadMoreBtn = document.getElementById('modalReadMoreBtn');

    cards.forEach(function (card) {
        card.addEventListener('click', function () {
            var title = this.getAttribute('data-title');
            var summary = this.getAttribute('data-summary');
            var link = this.getAttribute('data-link');
            var cachePath = this.getAttribute('data-cache-path');
            var images = this.getAttribute('data-images').split(',').filter(Boolean);

            modalTitle.textContent = title;
            modalSummary.textContent = summary;
            modalReadMoreBtn.href = link;

            // Populate image gallery
            modalGallery.innerHTML = ''; // Clear previous images
            if (images.length > 0) {
                images.forEach(function(imageFile) {
                    var galleryItem = document.createElement('div');
                    galleryItem.className = 'gallery-item';
                    
                    var img = document.createElement('img');
                    // Construct the correct, URL-encoded path for the image
                    var pathParts = (cachePath + '/' + imageFile).split('/').map(function(part) {
                        return encodeURIComponent(part);
                    });
                    img.src = '{{ site.baseurl }}/' + pathParts.join('/');
                    
                    galleryItem.appendChild(img);
                    modalGallery.appendChild(galleryItem);
                });
            }

            modal.modal('show');
        });
    });
});
</script>
