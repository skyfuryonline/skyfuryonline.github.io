---
layout: post
title: "åšå®¢çˆ¬è™«(ç»­)ï¼šä»AIæ€»ç»“åˆ°å®Œç¾UIä¸éƒ¨ç½²"
subtitle: "å®ç°å›¾æ–‡æ¨¡æ€æ¡†ï¼Œå¹¶è§£å†³ä¾èµ–å†²çªã€æƒé™ã€æ•°æ®æŒä¹…åŒ–ç­‰ä¸€ç³»åˆ—çœŸå®ä¸–ç•Œé—®é¢˜"
date: 2025-11-04 10:00:00
author: "LH"
tags: [LLM, UI, Jekyll, CI/CD, Debugging]
---

## å‰è¨€ï¼šä»â€œæ˜¯ä»€ä¹ˆâ€åˆ°â€œè®²ä»€ä¹ˆâ€ï¼Œå†åˆ°â€œçœ‹ä»€ä¹ˆâ€

åœ¨[ä¸Šä¸€ç¯‡æ•™ç¨‹](2025-11-03-add-crawler-to-jekyll-blog.md)ä¸­ï¼Œæˆ‘ä»¬ä¸ºåšå®¢é›†æˆäº†ä¸€ä¸ªå…¨è‡ªåŠ¨çš„çˆ¬è™«ã€‚ä½†è¿™ä»…ä»…æ˜¯å¼€å§‹ã€‚ä¸€ä¸ªå¥½çš„äº§å“ï¼Œä¸ä»…è¦æœ‰å†…å®¹ï¼Œæ›´è¦æœ‰ä¼˜ç§€çš„ä½“éªŒã€‚

è¿™ç¯‡æ•™ç¨‹ï¼Œæˆ‘ä»¬å°†è¿›è¡Œä¸€æ¬¡å½»åº•çš„â€œä½“éªŒå‡çº§â€ã€‚æˆ‘ä»¬å°†å®ç°ä»¥ä¸‹ç›®æ ‡ï¼š

1.  **é›†æˆ LLM**: å®ç°å¯¹æŠ“å–æ–‡ç« çš„**è‡ªåŠ¨æ‘˜è¦**åŠŸèƒ½ã€‚
2.  **å‡çº§ UI**: è®¾è®¡ä¸€ä¸ªå›¾æ–‡å¹¶èŒ‚çš„**æ¨¡æ€æ¡† (Modal)**ï¼Œåœ¨ä¸ç¦»å¼€é¡µé¢çš„æƒ…å†µä¸‹ï¼Œä¸ºç”¨æˆ·æä¾›â€œæ‘˜è¦ + å›¾ç‰‡â€çš„å¿«é€Ÿé¢„è§ˆã€‚
3.  **è§£å†³éƒ¨ç½²éš¾é¢˜**: è®°å½•å¹¶è§£å†³æˆ‘ä»¬åœ¨é›†æˆè¿‡ç¨‹ä¸­é‡åˆ°çš„**æ‰€æœ‰çœŸå®ä¸–ç•Œçš„éƒ¨ç½²é—®é¢˜**ï¼ŒåŒ…æ‹¬ä¾èµ–å†²çªã€æƒé™é”™è¯¯ã€æ•°æ®æŒä¹…åŒ–ç­–ç•¥ç­‰ã€‚è¿™éƒ¨åˆ†å°†æ˜¯æœ¬æ•™ç¨‹æœ€æœ‰ä»·å€¼çš„åœ°æ–¹ã€‚

## ç¬¬ä¸€éƒ¨åˆ†ï¼šLLM é›†æˆä¸ UI è®¾è®¡

### 1. è®¾è®¡å“²å­¦ï¼šé¢„ç”Ÿæˆä¸æ•°æ®é©±åŠ¨

æˆ‘ä»¬çš„æ ¸å¿ƒä¾ç„¶æ˜¯â€œé¢„ç”Ÿæˆâ€ã€‚æ‰€æœ‰éœ€è¦è®¡ç®—å’ŒAPIè°ƒç”¨çš„æ­¥éª¤ï¼Œéƒ½åœ¨æ„å»ºæ—¶å®Œæˆã€‚æœ€ç»ˆï¼Œå‰ç«¯æ‹¿åˆ°çš„ `daily_*.json` æ–‡ä»¶ï¼Œå°†åŒ…å«æ¸²æŸ“ä¸€ä¸ªå®Œç¾æ¨¡æ€æ¡†æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ï¼š

```json
{
    "title": "æ–‡ç« æ ‡é¢˜",
    "link": "åŸæ–‡é“¾æ¥",
    "summary": "AIæ€»ç»“...",
    "cache_path": "cache/2025-11-04/æ–‡ç« æ ‡é¢˜",
    "image_files": ["image_1.jpg", "image_2.jpg"]
}
```

### 2. åç«¯æ”¹é€ ï¼šè·å–å›¾ç‰‡åˆ—è¡¨ä¸ç›¸å¯¹è·¯å¾„

ä¸ºäº†å®ç°å›¾æ–‡å±•ç¤ºï¼Œæˆ‘ä»¬å¯¹çˆ¬è™«è„šæœ¬åšäº†ä¸¤å¤„å…³é”®ä¿®æ”¹ï¼š

*   **è·å–å›¾ç‰‡åˆ—è¡¨**: åœ¨ `main.py` ä¸­ï¼Œæˆ‘ä»¬å¢åŠ äº†æ‰«æç¼“å­˜ç›®å½•ã€è·å–æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶åçš„é€»è¾‘ã€‚
*   **ä¿®æ­£è·¯å¾„é—®é¢˜**: è¿™æ˜¯æˆ‘ä»¬é‡åˆ°çš„ç¬¬ä¸€ä¸ªå¤§å‘ã€‚æœ€åˆï¼Œæˆ‘ä»¬é”™è¯¯åœ°å°†æœåŠ¡å™¨çš„ç»å¯¹æ–‡ä»¶è·¯å¾„å­˜å…¥äº† `cache_path`ã€‚æˆ‘ä»¬å¿…é¡»ä¿®æ­£ `cnblogs_crawler.py`ï¼Œè®©å®ƒå­˜å…¥ç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„**ç›¸å¯¹è·¯å¾„**ï¼Œä¾‹å¦‚ `cache/2025-11-04/...`ã€‚

```python
# crawlers/cnblogs_crawler.py (å…³é”®ä¿®æ”¹)

# ...
# NOTE: We must store a relative path for the web URL, not the absolute filesystem path.
relative_cache_path = os.path.join("cache", os.path.basename(self.output_dir), safe_title)
metadata_items.append({
    "title": title,
    "link": link,
    "cache_path": relative_cache_path.replace('\\', '/') # Ensure forward slashes
})
```

### 3. å‰ç«¯å®ç°ï¼šæ¨¡æ€æ¡†ã€å›¾ç‰‡ç”»å»Šä¸ URL ç¼–ç 

æˆ‘ä»¬åœ¨ `daily.html` ä¸­è¿›è¡Œäº†å¤§é‡çš„å‰ç«¯å·¥ä½œï¼š

*   **HTML**: ä½¿ç”¨ Bootstrap çš„æ ‡å‡†æ¨¡æ€æ¡†ç»“æ„ï¼Œå¹¶ä¸ºæ–‡ç« å¡ç‰‡æ·»åŠ  `data-*` å±æ€§æ¥å­˜å‚¨æ‘˜è¦ã€å›¾ç‰‡åˆ—è¡¨å’Œç¼“å­˜è·¯å¾„ã€‚
*   **CSS**: ç¼–å†™äº†å›¾ç‰‡ç”»å»Šçš„æ ·å¼ã€‚ä¸ºäº†è®©å›¾ç‰‡ç¾è§‚ä¸”ä¸å˜å½¢ï¼Œæˆ‘ä»¬æœ€ç»ˆé‡‡ç”¨äº† `object-fit: cover` æ–¹æ¡ˆï¼Œå®ƒèƒ½è®©ä¸åŒå°ºå¯¸çš„å›¾ç‰‡éƒ½å®Œç¾åœ°å¡«å……ä¸€ä¸ªå›ºå®šå¤§å°çš„å®¹å™¨ã€‚

    ```css
    .gallery-item {
        height: 200px; /* ç»™å®¹å™¨ä¸€ä¸ªå›ºå®šé«˜åº¦ */
        /* ... å…¶ä»– flex å¸ƒå±€å±æ€§ ... */
    }
    .gallery-item img {
        width: 100%;
        height: 100%; /* è®©å›¾ç‰‡å¡«æ»¡å®¹å™¨ */
        object-fit: cover; /* è£å‰ªä»¥é€‚åº”ï¼Œä¸å˜å½¢ */
    }
    ```

*   **JavaScript**: è¿™æ˜¯äº¤äº’çš„æ ¸å¿ƒã€‚å½“å¡ç‰‡è¢«ç‚¹å‡»æ—¶ï¼š
    1.  ä» `data-*` å±æ€§ä¸­è¯»å–æ‰€æœ‰æ•°æ®ã€‚
    2.  å°†æ ‡é¢˜å’Œæ‘˜è¦å¡«å……åˆ°æ¨¡æ€æ¡†ä¸­ã€‚
    3.  **URL ç¼–ç **ï¼šè¿™æ˜¯æˆ‘ä»¬é‡åˆ°çš„ç¬¬äºŒä¸ªå¤§å‘ã€‚ç”±äºæ–‡ç« æ ‡é¢˜æ˜¯ä¸­æ–‡ï¼Œç›´æ¥æ‹¼æ¥çš„ URL æ˜¯éæ³•çš„ã€‚æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ `encodeURIComponent` å¯¹è·¯å¾„çš„æ¯ä¸ªéƒ¨åˆ†è¿›è¡Œç¼–ç ï¼Œæ‰èƒ½ç”Ÿæˆåˆæ³•çš„å›¾ç‰‡ `src`ã€‚

    ```javascript
    // daily.html (å…³é”®ä¿®æ”¹)

    // ...
    var pathParts = (cachePath + '/' + imageFile).split('/').map(function(part) {
        return encodeURIComponent(part);
    });
    img.src = '{{ site.baseurl }}/' + pathParts.join('/');
    ```

## ç¬¬äºŒéƒ¨åˆ†ï¼šéƒ¨ç½²çš„â€œä¹ä¹å…«åä¸€éš¾â€

å½“æˆ‘ä»¬æŠŠè¿™ä¸€åˆ‡æ¨é€åˆ° GitHub Actions æ—¶ï¼ŒçœŸæ­£çš„æŒ‘æˆ˜æ‰åˆšåˆšå¼€å§‹ã€‚æˆ‘ä»¬å‡ ä¹é‡åˆ°äº†æ‰€æœ‰æ–°æ‰‹åœ¨åš CI/CD æ—¶ä¼šé‡åˆ°çš„ç»å…¸é—®é¢˜ã€‚

### éš¾å…³ä¸€ï¼šPython ä¾èµ–å†²çª

*   **é—®é¢˜**: `crawl4ai` éœ€è¦ `anyio>=4.0.0`ï¼Œè€Œæ—§ç‰ˆçš„ `openai` åº“éœ€è¦ `anyio<4.0.0`ï¼Œä¸¤è€…å®Œå…¨å†²çªï¼Œå¯¼è‡´ `pip install` å¤±è´¥ã€‚
*   **è§£å†³æ–¹æ¡ˆ**: åœ¨ `requirements.txt` ä¸­ï¼Œ**ä¸é”å®š `openai` çš„ç‰ˆæœ¬**ï¼Œåªå†™ `openai`ã€‚è¿™ç­‰äºæˆæƒ `pip` çš„ä¾èµ–è§£æå™¨ï¼Œè®©å®ƒè‡ªå·±å»å¯»æ‰¾ä¸€ä¸ªèƒ½ä¸ `crawl4ai` å’Œè°å…±å­˜çš„ã€æœ€æ–°çš„ `openai` ç‰ˆæœ¬ã€‚

### éš¾å…³äºŒï¼šPython ç¼©è¿›é”™è¯¯

*   **é—®é¢˜**: `IndentationError`ã€‚ä¸€ä¸ªä½çº§ä½†è‡´å‘½çš„é”™è¯¯ï¼Œå› ä¸ºåœ¨ä¿®æ”¹ä»£ç æ—¶ç ´åäº† Python çš„ç¼©è¿›ç»“æ„ã€‚
*   **è§£å†³æ–¹æ¡ˆ**: ä»”ç»†æ£€æŸ¥æŠ¥é”™çš„è¡Œå·ï¼Œä¿®æ­£ç¼©è¿›ã€‚è¿™æ˜¯æ¯ä¸ª Python ç¨‹åºå‘˜çš„å¿…ç»ä¹‹è·¯ã€‚

### éš¾å…³ä¸‰ï¼šæ•°æ®æŒä¹…åŒ–çš„æƒé™é—®é¢˜

*   **é—®é¢˜**: æˆ‘ä»¬å¸Œæœ› Actions å°†çˆ¬å–çš„æ•°æ®æäº¤å›ä»“åº“ï¼Œä½† `git push` æŠ¥äº† `403 Permission Denied` é”™è¯¯ã€‚
*   **åŸå› **: Actions çš„é»˜è®¤ä»¤ç‰Œ `GITHUB_TOKEN` æ²¡æœ‰å‘ä»“åº“å†™å…¥çš„æƒé™ã€‚
*   **è§£å†³æ–¹æ¡ˆ**: åœ¨ `deploy.yml` ä¸­ï¼Œä¸º `build` ä»»åŠ¡æ˜ç¡®æˆäºˆ `contents: write` æƒé™ã€‚

    ```yaml
    jobs:
      build:
        permissions:
          contents: write # æˆäºˆå†™å…¥æƒé™
        steps:
        # ...
    ```

### éš¾å…³å››ï¼šä»£ç ä¸æ•°æ®çš„â€œæˆ˜äº‰â€

*   **é—®é¢˜**: æˆ‘ä»¬æœ¬åœ°åœ¨ä¿®æ”¹ä»£ç ï¼Œè€Œ Actions åœ¨è‡ªåŠ¨æäº¤æ•°æ®ï¼Œå½“æˆ‘ä»¬ `git pull` æ—¶ï¼Œä¼šå› ä¸ºæ•°æ®æ–‡ä»¶å¤ªå¤šè€Œå¡æ­»ï¼Œæˆ–è€…äº§ç”Ÿå¤§é‡åˆå¹¶å†²çªã€‚
*   **æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼šä»£ç ä¸æ•°æ®åˆ†ç¦»**
    1.  **`master` åˆ†æ”¯**: åªä¿å­˜ä»£ç ã€‚`.gitignore` ä¸­å¿½ç•¥ `cache/` å’Œ `_data/daily_*.json`ã€‚
    2.  **`data` åˆ†æ”¯**: åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ã€å­¤ç«‹çš„åˆ†æ”¯ï¼Œä¸“é—¨ç”¨äºå­˜æ”¾ `cache/` å’Œ `_data/`ã€‚
    3.  **æ”¹é€ å·¥ä½œæµ**: `deploy.yml` è¢«å½»åº•æ”¹é€ ã€‚å®ƒä¼šåŒæ—¶ `checkout` ä¸¤ä¸ªåˆ†æ”¯ï¼Œæ„å»ºæ—¶å°†ä¸¤è€…ç»“åˆï¼Œæ„å»ºç»“æŸåï¼Œ**åªå°†æ–°æ•°æ®æ¨é€å› `data` åˆ†æ”¯**ã€‚`master` åˆ†æ”¯æ°¸è¿œä¸ä¼šå†è¢« Actions è‡ªåŠ¨ä¿®æ”¹ã€‚

    ```yaml
    # deploy.yml (æ ¸å¿ƒé€»è¾‘)
    steps:
      - name: Checkout master branch (code) ğŸ›ï¸
        uses: actions/checkout@v4
        with:
          path: main

      - name: Checkout data branch (data) ğŸ“¦
        uses: actions/checkout@v4
        with:
          ref: data
          path: data
      
      # ... (è¿è¡Œçˆ¬è™«ï¼Œåœ¨ main ç›®å½•ç”Ÿæˆæ•°æ®)

      - name: Commit and push data to data branch ğŸ’¾
        run: |
          # 1. æŠŠ main ç›®å½•é‡Œæ–°ç”Ÿæˆçš„æ•°æ®ï¼Œå¤åˆ¶åˆ° data ç›®å½•
          cp -rf main/_data/. data/_data/
          cp -rf main/cache/. data/cache/

          # 2. è¿›å…¥ data ç›®å½•ï¼Œæ‰§è¡Œæäº¤
          cd data
          git add -A
          git commit -m "chore: Update daily data"
          git push
    ```

### éš¾å…³äº”ï¼š`.gitignore` çš„â€œä¸¤é¢æ€§â€

*   **é—®é¢˜**: å³ä½¿æˆ‘ä»¬é‡‡ç”¨äº†åŒåˆ†æ”¯ç­–ç•¥ï¼Œ`git push` ä¾ç„¶æŠ¥é”™ï¼Œæç¤º `_data` ç›®å½•è¢« `.gitignore` å¿½ç•¥äº†ã€‚
*   **åŸå› **: Actions åœ¨ `data` ç›®å½•ä¸­æ‰§è¡Œ `git add` æ—¶ï¼Œä¾ç„¶å—åˆ°äº† `master` åˆ†æ”¯æ£€å‡ºåˆ° `main` ç›®å½•ä¸­çš„é‚£ä¸ª `.gitignore` æ–‡ä»¶çš„å½±å“ã€‚
*   **è§£å†³æ–¹æ¡ˆ**: åœ¨ `deploy.yml` çš„æäº¤æ­¥éª¤ä¸­ï¼Œä½¿ç”¨ `git add -A` (æˆ– `-f`) æ¥å¼ºåˆ¶æ·»åŠ æ–‡ä»¶ï¼Œæ— è§† `.gitignore` çš„è§„åˆ™ã€‚

## æ€»ç»“ï¼šæ²¡æœ‰ä¸€å¸†é£é¡ºçš„å·¥ç¨‹

ä»ä¸€ä¸ªç®€å•çš„æƒ³æ³•ï¼Œåˆ°ä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€ä½“éªŒè‰¯å¥½ã€éƒ¨ç½²å¥å£®çš„è‡ªåŠ¨åŒ–ç³»ç»Ÿï¼Œæˆ‘ä»¬å‡ ä¹æŠŠæ–°æ‰‹èƒ½è¸©çš„å‘éƒ½è¸©äº†ä¸€éã€‚ä½†æ­£æ˜¯è¿™ä¸ªè¿‡ç¨‹ï¼Œè®©æˆ‘ä»¬å¯¹ CI/CDã€Git å¤šåˆ†æ”¯åä½œã€å‰ç«¯è·¯å¾„å¤„ç†ã€CSS å¸ƒå±€ç­‰ä¸€ç³»åˆ—å·¥ç¨‹é—®é¢˜ï¼Œæœ‰äº†æ— æ¯”æ·±åˆ»å’Œå…·è±¡çš„ç†è§£ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬çš„åšå®¢ç»ˆäºæ‹¥æœ‰äº†ä¸€ä¸ªèƒ½çœŸæ­£è®©äººæ„‰æ‚¦åœ°ä½¿ç”¨çš„ã€è‡ªæˆ‘æ›´æ–°çš„â€œæƒ…æŠ¥ä¸­å¿ƒâ€ã€‚è¿™ä¸ªè¿‡ç¨‹è™½ç„¶æ›²æŠ˜ï¼Œä½†ç»“æœä»¤äººæ»¡æ„ã€‚